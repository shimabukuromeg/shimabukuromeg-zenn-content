---
title: "Create Figma Plugin ã‚’ä½¿ã£ã¦ Figma Plugin é–‹ç™ºã«å…¥é–€ã—ã¦ã¿ã‚‹ã"
emoji: "ğŸ£"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["figma", "react"]
published: true
publication_name: "monicle"
---

# ã¯ã˜ã‚ã«

- ã“ã®è¨˜äº‹ã¯ Figma Plugin ã«å…¥é–€ã—ã¦ã¿ãŸããªã£ã¦ã€ã„ã‚ã„ã‚ã¨è©¦ã—ãŸã“ã¨ã‚’ã¾ã¨ã‚ãŸè¨˜äº‹ã§ã™
- Figma Plugin ã«å…¥é–€ã—ãŸããªã£ãŸãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³
    - ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã•ã‚“ã¨ã„ã„æ„Ÿã˜ã«ä»•äº‹ã§ãã‚‹ã‚ˆã†ã«Figmaã®çŸ¥è­˜ã‚’æŒã£ã¦ãŠããŸã‹ã£ãŸ
    - Figma Plugin ãŒã©ã†ã„ã†ä»•çµ„ã¿ã§å‹•ã„ã¦ã‚‹ã®ã‹æ°—ã«ãªã£ã¦ãŸ
    - [Create Figma Plugin](https://github.com/yuanqing/create-figma-plugin) ãŒæ°—ã«ãªã£ã¦ãŸ
- Create Figma Plugin ã‚’ä½¿ã£ã¦ Figma Plugin ã‚’é–‹ç™ºã—ã¦ã¿ãŸã„äººã®å‚è€ƒã«ãªã‚Œã°å¬‰ã—ã„ã§ã™

# Figma Pluginã¨ã¯

Figmaã¯ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦æ©Ÿèƒ½æ‹¡å¼µã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è©³ç´°ã¯ã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¦

https://www.figma.com/plugin-docs/


ä¸–ã®ä¸­ã«ã¯ä¾¿åˆ©ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒãŸãã•ã‚“å…¬é–‹ã•ã‚Œã¦ã‚‹ã€‚ä»¥ä¸‹ã€æœ€è¿‘è‰¯ã„ãªã¨æ€ã£ãŸé©å½“ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³

https://www.figma.com/community/plugin/843461159747178978/Figma-Tokens

https://www.figma.com/community/plugin/1159123024924461424/html.to.design

https://www.figma.com/community/plugin/1160642826057169962/Figma-Autoname

ã¾ãŸã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯è‡ªåˆ†ã§ä½œã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚Figmaã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚ã‚‹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰é€šã‚Šã«è©¦ã—ã¦ã¿ã‚‹ã¨ã€ã‚µãƒ³ãƒ—ãƒ«ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼ˆrectanglesç”Ÿæˆã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼‰ã‚’å‹•ã‹ã—ã¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è©³ç´°ã¯ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã«ã¦

https://www.figma.com/plugin-docs/setup/


# Create Figma Pluginã¨ã¯

Create Figma Pluginã¯ã€Figma Plugin ã®é–‹ç™ºã§åˆ©ç”¨ã™ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚„UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€ãƒ“ãƒ«ãƒ‰å‘¨ã‚Šã®æ•´å‚™ãªã©ã‚’ã„ã„æ„Ÿã˜ã«æä¾›ã—ã¦ãã‚Œã¦ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

https://github.com/yuanqing/create-figma-plugin

https://yuanqing.github.io/create-figma-plugin/

Figmaã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚ã‚‹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ï¼ˆFigmaã®ã‚¢ãƒ—ãƒªã‹ã‚‰initã™ã‚‹æ–¹æ³•ï¼‰ã‹ã‚‰ åˆæœŸåŒ–ã—ãŸçŠ¶æ…‹ã¯ã€å‰²ã¨ã‚·ãƒ³ãƒ—ãƒ«ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™ºã«å¿…è¦ãªæœ€ä½é™ã®çŠ¶æ…‹ãªã®ã§ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’é–‹ç™ºã™ã‚‹ãŸã‚ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚„UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãªã©ãŒå……å®Ÿã—ã¦æ¬²ã—ã„å ´åˆã¯ã€Create Figma Pluginã‚’ä½¿ã†ã¨ä¾¿åˆ©ã§è‰¯ã•ãã†ã§ã™ã€‚

# Create Figma Pluginã‚’ä½¿ã£ã¦ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‹•ã‹ã—ã¦ã¿ã‚‹

Create Figma Pluginã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã® [ã‚¯ã‚¤ãƒƒã‚¯ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆ](https://yuanqing.github.io/create-figma-plugin/quick-start/) ã‚’å‚è€ƒã«å‹•ã‹ã—ã¦ã¿ã¾ã™ã€‚reactã‚’ä½¿ã„ãŸã‹ã£ãŸã®ã§ã€`plugin/react-editor` ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠã—ã¾ãŸã€‚

```bash
$ npx --yes create-figma-plugin
? Select a template: plugin/react-editor
First:
  cd react-editor

To build the plugin:
  npm run build

To watch for code changes and rebuild the plugin automatically:
  npm run watch

$ cd react-editor
```

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ä¸€éƒ¨ä¿®æ­£ã—ãªã„ã¨ã„ã‘ãªã„ç‚¹ãŒã‚ã‚Šã€ä¸‹è¨˜ã®`src/ui.tsx` äºŒè¡Œã‚’å‰Šé™¤ã—ã¾ã™ã€‚ï¼ˆ[å‚è€ƒ](https://github.com/yuanqing/create-figma-plugin/issues/125)ï¼‰

```typescript
+// import 'prismjs/components/prism-clike.js'
+// import 'prismjs/components/prism-javascript.js'
```

ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚

```bash
$ npm run build
```

Figmaã®ã‚¢ãƒ—ãƒªã«ã¦ã€é–‹ç™ºä¸­ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å–ã‚Šè¾¼ã‚€ãŸã‚ã€react-editor ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã«ã‚ã‚‹ `manifest.json` ã‚’importã—ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/fd1b006f017f-20221016.png)

é–‹ç™ºç”¨ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ react-editor ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«å…ƒã€…ç”¨æ„ã•ã‚Œã¦ã‚‹æ©Ÿèƒ½ãŒä½¿ãˆã¾ã™ã€‚Insert Codeãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ã‚³ãƒ¼ãƒ‰ã®ãƒ†ã‚­ã‚¹ãƒˆãŒFigmaä¸Šã«æŒ¿å…¥ã•ã‚Œã¾ã™ã€‚ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®react-editorã®æ©Ÿèƒ½ï¼‰

![](https://storage.googleapis.com/zenn-user-upload/d927367c331d-20221016.png)


ä»¥ä¸Šã§ã€Create Figma Pluginã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å‹•ã‹ã—ã¦ã¿ã‚‹ã¯çµ‚ã‚ã‚Šã§ã™ã€‚

# Create Figma Plugin ã§ã®å‡¦ç†æ¦‚è¦

### ãã‚‚ãã‚‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒ Figma ã§å‹•ãä»•çµ„ã¿

ã¾ãšã€ãã‚‚ãã‚‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒ Figma ä¸Šã§ã©ã®ã‚ˆã†ã«å®Ÿè¡Œã•ã‚Œã¦ã‚‹ã‹ã«ã¤ã„ã¦ã§ã™ã€‚

ã–ã£ãã‚Šã„ã†ã¨ UIå´ã®ã‚³ãƒ¼ãƒ‰ã¨ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰å´ã®ã‚³ãƒ¼ãƒ‰ãŒ postMessage ã‚’é€šã—ã¦ã‚„ã‚Šã¨ã‚Šã—ã¦å‹•ãä»•çµ„ã¿ã§ã™ã€‚

- ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰å´ã®ã‚³ãƒ¼ãƒ‰
    - Figma ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ§‹æˆã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®éšå±¤ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦æ“ä½œã§ãã‚‹ã‚³ãƒ¼ãƒ‰ã€‚UIå´ã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘å–ã£ã¦ã€Figmaãƒ¬ã‚¤ãƒ¤ãƒ¼å´ã®æ“ä½œã‚’ã—ãŸã‚Šã€Figmaãƒ¬ã‚¤ãƒ¤ãƒ¼å´ã§å‡¦ç†ã—ãŸçµæœã‚’UIå´ã«è¿”ã™ã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’æŠ•ã’ãŸã‚Šã™ã‚‹
- UIå´ã®ã‚³ãƒ¼ãƒ‰
    - ãƒ–ãƒ©ã‚¦ã‚¶ API ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ã Figmaã®ã‚¢ãƒ—ãƒªä¸Šã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®æ“ä½œã‚’å—ã‘ä»˜ã‘ãŸã‚Šã€æƒ…å ±ã‚’è¡¨ç¤ºã—ãŸã‚Šã™ã‚‹ã‚³ãƒ¼ãƒ‰ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å…¥åŠ›ã‚’å—ã‘å–ã£ã¦ã€Figmaãƒ¬ã‚¤ãƒ¤ãƒ¼å´ã§å¿…è¦ãªå‡¦ç†ã«ã¤ã„ã¦ã€ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰å´ã«ã‚¤ãƒ™ãƒ³ãƒˆæŠ•ã’ãŸã‚Šã€ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰å´ã‹ã‚‰UIã§è¡¨ç¤ºã•ã›ã¦ã»ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘ã¨ã£ã¦è¡¨ç¤ºã•ã›ãŸã‚Šã™ã‚‹

è©³ç´°ã¯ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è©³ã—ãæ›¸ã„ã¦ã„ã¾ã™ã€‚

https://www.figma.com/plugin-docs/how-plugins-run/


ä»¥ä¸‹ã€ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰å´ã®ã‚³ãƒ¼ãƒ‰ã¨UIå´ã®å‡¦ç†ã®é–¢ä¿‚æ€§ã«ã¤ã„ã¦ã€å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ã¨åˆã‚ã›ã¦ã¾ã¨ã‚ã¦è¦‹ã¾ã—ãŸã€‚

![](https://storage.googleapis.com/zenn-user-upload/8ee87aad4abe-20221019.png)

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã©ã®ã‚ˆã†ã«å‹•ä½œã—ã¦ã„ã‚‹ã®ã‹ã«ã¤ã„ã¦ã¯ã€ã“ã®è¨˜äº‹ã‚‚ã‚ã‹ã‚Šã‚„ã™ã‹ã£ãŸã§ã™ã€‚

https://zenn.dev/ixkaito/articles/how-to-make-a-figma-plugin#%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3%E3%81%8C%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AB%E5%8B%95%E4%BD%9C%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%81%AE%E3%81%8B

### Create Figma Plugin ã®å ´åˆ

Create Figma Plugin ã§ã¯ã€ä¸Šè¨˜ã®ä»•çµ„ã¿ã‚’ã„ã„æ„Ÿã˜ã«ãƒ©ãƒƒãƒ—ã—ãŸãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã‚’æä¾›ã—ã¦ãŸã‚Šã€generateã—ãŸéš›ã§ãã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã†ã¨ `main.ts`ã€`ui.tsx ` ãªã©ãŒç”Ÿæˆã•ã‚Œã‚‹ï¼‰ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ã‚ã‹ã‚Šã‚„ã™ããªã£ã¦ã„ã¾ã™ã€‚

- [main.ts](https://yuanqing.github.io/create-figma-plugin/configuration/#main) ã¯ã€ãƒ¡ã‚¤ãƒ³ã¨ãªã‚‹ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã§ã€Figmaã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ“ä½œã™ã‚‹ãªã©ã®å‡¦ç†ã‚’æ›¸ãã¾ã™ã€‚

- [ui.tsx](https://yuanqing.github.io/create-figma-plugin/configuration/#ui) ã¯ã€UIå´ã®ã‚³ãƒ¼ãƒ‰ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å…¥åŠ›ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ãªã©ã®å‡¦ç†ã‚’æ›¸ãã¾ã™ã€‚

```bash
$ tree ./src -L 1
./src
â”œâ”€â”€ main.ts # sandboxã€‚ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰å´ã®ã‚³ãƒ¼ãƒ‰ã€‚Figmaãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ“ä½œãªã©ã€‚
â”œâ”€â”€ styles.css
â”œâ”€â”€ styles.css.d.ts
â”œâ”€â”€ types.ts
â””â”€â”€ ui.tsx # iframeã€‚UIå´ã®ã‚³ãƒ¼ãƒ‰ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å…¥åŠ›ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ãªã©ã€‚
```

ä¸Šè¿°ã—ãŸ `postMessage`ã€`onmessage` ã®ã‚„ã‚Šã¨ã‚Šã®ã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã‚’ä½¿ã£ã¦æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚

- `emit<Handler>(name, ...args)` ã§ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«

- `on<Handler>(name, handler)` ã§ã‚¤ãƒ™ãƒ³ãƒˆå—ã‘å–ã‚‹

è©³ç´°ã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

https://yuanqing.github.io/create-figma-plugin/utilities/#events



# Create Figma Plugin ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ”¹è‰¯ã—ã¦Text StylesãŒé©ç”¨ã•ã‚Œã¦ã„ãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã‚’æ¢ã™æ©Ÿèƒ½ã‚’ä½œã£ã¦ã¿ã‚‹

ç¶šã„ã¦ã€å‹•ã‹ã—ã¦ã¿ãŸä¸Šè¨˜ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ™ãƒ¼ã‚¹ã«æ©Ÿèƒ½ã‚’è¶³ã—ã¦ã¿ã¾ã™ã€‚å®šç¾©æ¸ˆã®ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ãŒé©ç”¨ã•ã‚Œã¦ãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ãŒãªã„ã‹ã‹ã©ã†ã‹ï¼ˆé‡è‰¯ã‚¹ã‚¿ã‚¤ãƒ«ãŒä½¿ã‚ã‚Œã¦ãªã„ã‹ã©ã†ã‹ï¼‰ãƒã‚§ãƒƒã‚¯ã™ã‚‹æ©Ÿèƒ½ã‚’ä½œã£ã¦ã¿ã¾ã™ã€‚

:::message
å®šç¾©æ¸ˆã®ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ãŒé©ç”¨ã•ã‚Œã¦ãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ãŒãªã„ã‹ã‹ã©ã†ã‹åˆ¤å®šã™ã‚‹æ©Ÿèƒ½ã¯ã€ä»¥ä¸‹ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ã£ãŸæ©Ÿèƒ½ã‚’çœŸä¼¼ã—ã¾ã—ãŸã€‚

ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªè‡ªä½“ã¯ã€Figmaã®ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã®ãƒªãƒ³ã‚¿ãƒ¼ã¨ã—ã¦æ©Ÿèƒ½ã—ã¦ãã‚Œã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã€ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ä»¥å¤–ã«ãƒã‚§ãƒƒã‚¯ã§ãã‚‹é …ç›®ãŒãŸãã•ã‚“ã‚ã‚Šä¾¿åˆ©ãã†ã§ã—ãŸã€‚

https://github.com/destefanis/design-lint
:::


ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´

:::details src/main.ts

ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰å´ã®å‡¦ç†

```typescript
import { loadFontsAsync, once, on, emit, showUI } from '@create-figma-plugin/utilities'

import { RunAppHandler, FirstNodeHandler, SelectTextNodeHandler } from './types'

export default function () {
  on<RunAppHandler>('RUN_APP', async function () {
    if (figma.currentPage.selection.length === 0) {
      console.log("No selection");
      figma.notify("Select a frame(s) to get started", { timeout: 2000 });
      return;
    } else {
      let nodes = figma.currentPage.selection;
      let firstNode = [];

      firstNode.push(figma.currentPage.selection[0]);

      const errors = lint(firstNode);

      emit<FirstNodeHandler>('FIRST_NODE', errors);

    }
  })
  on<SelectTextNodeHandler>('SELECT_TEXT_NODE', async function (node: TextNode) {
    figma.currentPage.selection = [node]
    figma.viewport.scrollAndZoomIntoView([node])
  })
  showUI({ height: 400, width: 320 })
}

function lint(nodes: any) {
  let errorArray: any = [];
  let childArray: any = [];

  nodes.forEach((node: any) => {

    // Create a new object.
    let newObject: any = {};

    // Give it the existing node id.
    newObject["id"] = node.id;

    let children = node.children;

    newObject["errors"] = determineType(node);

    if (!children) {
      errorArray.push(newObject);
      return;
    } else if (children) {
      // Recursively run this function to flatten out children and grandchildren nodes
      node["children"].forEach((childNode: any) => {
        childArray.push(childNode.id);
      });

      newObject["children"] = childArray;

      // If the layer is locked, pass the optional parameter to the recursive Lint
      // function to indicate this layer is locked.
      errorArray.push(...lint(node["children"]));
    }

    errorArray.push(newObject);
  });

  return errorArray;
}

function determineType(node: any) {
  if (node.type === "TEXT") {
    return lintTextRules(node);
  }
}


function lintTextRules(node: any) {
  let errors: any[] = [];
  checkType(node, errors);
  return errors;
}

function checkType(node: any, errors: any) {
  if (node.textStyleId === "" && node.visible === true) {
    let textObject = {
      font: "",
      fontStyle: "",
      fontSize: "",
      lineHeight: {}
    };

    let fontStyle = node.fontName;
    let fontSize = node.fontName;

    if (typeof fontSize === "symbol") {
      return errors.push(
        createErrorObject(
          node,
          "text",
          "Missing text style",
          "Mixed sizes or families"
        )
      );
    }

    if (typeof fontStyle === "symbol") {
      return errors.push(
        createErrorObject(
          node,
          "text",
          "Missing text style",
          "Mixed sizes or families"
        )
      );
    }

    textObject.font = node.fontName.family;
    textObject.fontStyle = node.fontName.style;
    textObject.fontSize = node.fontSize;

    // Line height can be "auto" or a pixel value
    if (node.lineHeight.value !== undefined) {
      textObject.lineHeight = node.lineHeight.value;
    } else {
      textObject.lineHeight = "Auto";
    }

    let currentStyle = `${textObject.font} ${textObject.fontStyle} / ${textObject.fontSize} (${textObject.lineHeight} line-height)`;

    return errors.push(
      createErrorObject(node, "text", "Missing text style", currentStyle)
    );
  } else {
    return;
  }
}

function createErrorObject(node: any, type: any, message: any, value?: any) {
  let error = {
    message: "",
    type: "",
    node: "",
    value: ""
  };

  error.message = message;
  error.type = type;
  error.node = node;

  if (value !== undefined) {
    error.value = value;
  }

  return error;
}
```
:::

:::details src/types.ts
```typescript
import { EventHandler } from '@create-figma-plugin/utilities'

export interface RunAppHandler extends EventHandler {
  name: 'RUN_APP'
  handler: () => void
}

export interface FirstNodeHandler extends EventHandler {
  name: 'FIRST_NODE'
  handler: (node: any) => void
}

export interface SelectTextNodeHandler extends EventHandler {
  name: 'SELECT_TEXT_NODE'
  handler: (node: TextNode) => void
}
```
:::

:::details src/ui.tsx

UIå´ã®å‡¦ç†


```typescript
import {
  Button,
  Container,
  render,
  VerticalSpace,
  Text,
  Banner,
  IconInfo32,
} from '@create-figma-plugin/ui'
import { emit, on } from '@create-figma-plugin/utilities'
import { h } from 'preact'
import { useCallback, useState } from 'preact/hooks'

import styles from './styles.css'
import { FirstNodeHandler, RunAppHandler, SelectTextNodeHandler } from './types'

function Plugin() {
  const [firstNodeArray, setFirstNodeArray] = useState<SceneNode[] | null>([])
  const [isSelected, setIsSelected] = useState<boolean>(false)
  const handleRunAppButtonClick = useCallback(
    function () {
      emit<RunAppHandler>('RUN_APP')
    },
    []
  )
  const handleSelectTextNodeButtonClick = (node: TextNode) => emit<SelectTextNodeHandler>('SELECT_TEXT_NODE', node)

  on<FirstNodeHandler>('FIRST_NODE', function (nodeArray: SceneNode[]) {
    // Reduce the size of our array of errors by removing nodes with no errors on them.
    let filteredErrorArray = nodeArray.filter(
      (item: any) => item.errors !== undefined && item.errors.length >= 1
    );

    setIsSelected(nodeArray.length > 0)
    setFirstNodeArray(filteredErrorArray)
  })

  return (
    <Container space="medium">
      <VerticalSpace space="small" />
      <div class={styles.container}>
        {
          firstNodeArray && firstNodeArray.length > 0 ?
            firstNodeArray.map((item: any, index) => {
              console.log("item", item);
              return (
                <Banner variant="warning" icon={<IconInfo32 />} style={{ "margin-bottom": "10px" }}>
                  <Text style={{ "margin-bottom": "10px", "color": "black" }}>{`${index + 1}. ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ãŒé©ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“`}</Text>
                  <Text style={{ "margin-bottom": "10px", "color": "black" }}>{item.errors[0].value}</Text>
                  <Button danger onClick={() => {
                    handleSelectTextNodeButtonClick(item)
                  }}>é¸æŠã™ã‚‹</Button>
                </Banner>
              )
            })
            : (
              isSelected ? (<Text>ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ã®é©ç”¨æ¼ã‚Œã¯ã‚ã‚Šã¾ã›ã‚“</Text>) : (<Text>ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’é¸æŠã—ã¦ä¸‹ã•ã„</Text>)
            )
        }
      </div>
      <VerticalSpace space="large" />
      <Button fullWidth onClick={handleRunAppButtonClick}>
        ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ã®é©ç”¨æ¼ã‚Œã‚’æ¤œå‡ºã™ã‚‹
      </Button>
      <VerticalSpace space="small" />
    </Container>
  )
}

export default render(Plugin)
```
:::

å®Œæˆï¼ï¼ï¼

![](https://storage.googleapis.com/zenn-user-upload/20c4bdad5cc0-20221019.gif)

å®Œæˆã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

https://github.com/shimabukuromeg/text-node-check-figma-plugin

# ãŠã‚ã‚Šã«

- figma pluginã‚’ä½œã‚‹ãŸã‚ã« figmaã§è‰²ã€…éŠã‚“ã§ã¿ãŸçµæœã€figmaã®æ“ä½œæ–¹æ³•ã‚„ã‚ªãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãªã©ã®ä»•çµ„ã¿ã‚’è¦šãˆã‚Œã¦ã‚ˆã‹ã£ãŸã€‚figmaã®æ“ä½œæ„Ÿã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ã‚‹æ„Ÿè¦šã¨è¿‘ã„ãªã¨ã„ã†æ„Ÿè§¦ã‚’å¾—ã‚ŒãŸã®ã‚‚ã‚ˆã‹ã£ãŸã€‚ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã•ã‚“ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ã§ãã‚‹èª¬ã‚ã‚‹

- figma pluginã„ã‚ã„ã‚çœºã‚ã¦ã‚‹ã¨ã€ä¾¿åˆ©ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒãŸãã•ã‚“ã‚ã£ã¦ã€ã»ã‚“ã¨ã¿ã‚“ãªã™ã”ã„ãªã‚ã¨ã„ã†æ°—æŒã¡ã«ãªã£ãŸ

- figma to react ãªã©ã®ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã™ã‚‹æœªæ¥ã‚‚å‰²ã¨ã„ã‘ã‚‹ã®ã§ã¯ã€ã¿ãŸã„ãªæ°—æŒã¡ã«ãªã£ãŸã®ã§ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ Ã— Figma ã®é ˜åŸŸå¼•ãç¶šããƒã‚§ãƒƒã‚¯ã—ã¦ã„ããŸã„


# å‚è€ƒ

https://speakerdeck.com/mottox2/create-figma-plugin?slide=17

https://zenn.dev/seya/articles/127027b75dbba0

https://github.com/destefanis/design-lint

https://www.figma.com/plugin-docs/api/properties/PageNode-selection

https://www.figma.com/plugin-docs/api/properties/figma-mixed

https://www.figma.com/plugin-docs/api/nodes